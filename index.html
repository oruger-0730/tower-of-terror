<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Elevator Control Panel</title>
<style>
body {
  background: #1d1f27;
  color: #fff;
  font-family: "Segoe UI", sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  user-select: none;
}
.panel {
  background: #2c2f3a;
  padding: 25px;
  border-radius: 15px;
  width: 390px;
  box-shadow: 0 0 10px rgba(0,0,0,.6);
}
h1 {
  text-align: center;
  margin-top: 0;
  font-size: 26px;
}
.floors {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
  margin-bottom: 25px;
}
button {
  padding: 12px;
  border: none;
  background: #444857;
  color: white;
  font-size: 17px;
  border-radius: 8px;
  cursor: pointer;
  transition: .2s;
}
button:disabled {
  opacity: .4;
  cursor: not-allowed;
}
button.active {
  background: #ff972d;
}
.toggleRow {
  display: flex;
  justify-content: space-between;
  margin-top: 12px;
}
#log {
  margin-top: 18px;
  border: 1px solid #555;
  padding: 10px;
  height: 100px;
  overflow-y: auto;
  font-size: 14px;
  background: #111;
}
#elevatorBox {
  width: 320px;
  height: 160px;
  margin: 12px auto;
  border: 3px solid #999;
  position: relative;
  overflow: hidden;
  background: #0a0e12;
}
#cabin {
  position: absolute;
  width: 100%;
  height: 100%;
  background: #9ca8b3;
  transition: top 2.4s linear;
}
#doors {
  position: absolute;
  width: 100%;
  height: 100%;
}
.door {
  width: 50%;
  height: 100%;
  background: #cbd6e0;
  position: absolute;
  transition: .8s;
}
#leftDoor { left: 0; }
#rightDoor { right: 0; }
.dark {
  background: #0a0b10 !important;
}
</style>
</head>
<body>

<div class="panel">
  <h1>Elevator Control</h1>
  <div id="elevatorBox">
    <div id="cabin"></div>
    <div id="doors">
      <div id="leftDoor" class="door"></div>
      <div id="rightDoor" class="door"></div>
    </div>
  </div>

  <div class="floors">
    <button class="floorBtn" data-floor="1">1</button>
    <button class="floorBtn" data-floor="2">2</button>
    <button class="floorBtn" data-floor="3">3</button>
    <button class="floorBtn" data-floor="4">4</button>
    <button class="floorBtn" data-floor="5">5</button>
    <button class="floorBtn" data-floor="6">6</button>
  </div>

  <div class="toggleRow">
    <button id="autoBtn">AUTO</button>
    <button id="nightBtn">Night</button>
  </div>

  <div id="log"></div>
</div>

<script>
let currentFloor = 1;
let moving = false;
let autoMode = false;
let night = false;
let callQueue = [];
let autoTimer;

const cabin = document.getElementById("cabin");
const leftDoor = document.getElementById("leftDoor");
const rightDoor = document.getElementById("rightDoor");
const log = document.getElementById("log");
const autoBtn = document.getElementById("autoBtn");
const nightBtn = document.getElementById("nightBtn");
const floorBtns = document.querySelectorAll(".floorBtn");

function addLog(text) {
  log.innerHTML += text + "<br>";
  log.scrollTop = log.scrollHeight;
}

// ãƒ‰ã‚¢å‹•ä½œ
function openDoors() {
  leftDoor.style.transform = "translateX(-100%)";
  rightDoor.style.transform = "translateX(100%)";
}
function closeDoors() {
  leftDoor.style.transform = "translateX(0)";
  rightDoor.style.transform = "translateX(0)";
}

// æ‰‹å‹•æŠ¼ä¸‹
floorBtns.forEach(btn => {
  btn.addEventListener("click", () => {
    if (moving || autoMode) return;
    moveToFloor(Number(btn.dataset.floor));
  });
});

// ãƒ¡ã‚¤ãƒ³ç§»å‹•
function moveToFloor(target) {
  if (moving) return;
  moving = true;
  closeDoors();
  addLog(`âž¡ ç§»å‹•: ${currentFloor}F â†’ ${target}F`);
  cabin.style.top = `-${(target - 1) * 80}px`;
  let duration = night ? 4200 : 2400;
  setTimeout(() => {
    currentFloor = target;
    openDoors();
    addLog(`âœ” åˆ°ç€: ${currentFloor}F`);
    setTimeout(() => {
      closeDoors();
      moving = false;
    }, 800);
  }, duration);
}

// è‡ªå‹•é‹è»¢
function autoLoop() {
  if (!autoMode) return;
  if (callQueue.length === 0) return;

  let next = callQueue.shift();
  highlightButton(next);
  moveToFloor(next);

  let stopTime = Math.random() * 3000 + 1000; // 1ã€œ4ç§’
  setTimeout(autoLoop, stopTime + 2500);
}

function highlightButton(f) {
  const btn = document.querySelector(`.floorBtn[data-floor="${f}"]`);
  if (!btn) return;
  btn.classList.add("active");
  setTimeout(() => btn.classList.remove("active"), 1500);
}

// å‘¼ã³å‡ºã—ç”Ÿæˆ
function startCallGenerator() {
  autoTimer = setInterval(() => {
    let floor = Math.floor(Math.random() * 6) + 1;
    callQueue.push(floor);
    addLog(`ðŸ“ž å‘¼ã³å‡ºã—: ${floor}F`);
  }, Math.random() * 4000 + 5000);
}

function stopCallGenerator() {
  clearInterval(autoTimer);
}

// AUTOãƒœã‚¿ãƒ³
autoBtn.addEventListener("click", () => {
  autoMode = !autoMode;
  autoBtn.classList.toggle("active", autoMode);
  addLog(autoMode ? "ðŸŸ¢ è‡ªå‹•é‹è»¢é–‹å§‹" : "ðŸ”´ è‡ªå‹•é‹è»¢åœæ­¢");

  if (autoMode) {
    floorBtns.forEach(b => (b.disabled = true));
    startCallGenerator();
    setTimeout(autoLoop, 1000);
  } else {
    stopCallGenerator();
    floorBtns.forEach(b => (b.disabled = false));
  }
});

// Nightãƒ¢ãƒ¼ãƒ‰
nightBtn.addEventListener("click", () => {
  night = !night;
  nightBtn.classList.toggle("active", night);
  document.body.classList.toggle("dark", night);
  addLog(night ? "ðŸŒ™ Nightãƒ¢ãƒ¼ãƒ‰" : "â˜€ æ˜¼ãƒ¢ãƒ¼ãƒ‰");
});
</script>
</body>
</html>
